<%- include("header.ejs") %>

<body>
  <div class="container mx-auto p-8">
    <!-- Header Section -->
    <header class="mb-8">
      <h1 class="text-3xl font-bold text-center text-blue-600">Newsletter Subscribers Management</h1>
    </header>

    <!-- Add Subscriber Section (Optional) -->
    <section class="my-8">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Add New Subscriber</h2>
      <form action="/admin/subscribe" method="POST" class="bg-white p-6 rounded-lg shadow-md max-w-md mx-auto space-y-4">
        <div>
          <label for="email" class="block text-sm font-medium text-gray-700">Email:</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="subscriber@example.com"
            required
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
          >
        </div>
        <div>
          <button
            type="submit"
            class="w-full bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
          >
            Add Subscriber
          </button>
        </div>
      </form>
    </section>

    <!-- List Subscribers Section -->
    <section class="my-8">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Existing Subscribers</h2>
      <% if (subscribers && subscribers.length > 0) { %>
        <table class="min-w-full bg-white rounded-lg shadow-md">
          <thead>
            <tr class="bg-gray-200">
              <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Email</th>
              <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Subscribed On</th>
              <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% subscribers.forEach(subscriber => { %>
              <tr class="border-b hover:bg-gray-50">
                <td class="px-4 py-2 text-sm text-gray-700">
                  <form action="/admin/subscribe/<%= subscriber._id %>?_method=PUT" method="POST" class="flex items-center space-x-2">
                    <h6><%= subscriber.email %></h6>
                  </form>
                </td>
                <td class="px-4 py-2 text-sm text-gray-500">
                  <%= new Date(subscriber.createdAt).toLocaleDateString() %>
                </td>
                <td class="px-4 py-2 space-x-2">
                  <form action="/admin/subscribe/<%= subscriber._id %>?_method=DELETE" method="POST" style="display:inline-block;">
                    <button
                      type="submit"
                      onclick="return confirm('Are you sure you want to delete this subscriber?')"
                      class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700"
                    >
                      Delete
                    </button>
                  </form>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      <% } else { %>
        <p class="text-center text-gray-500 py-4">No subscribers found.</p>
      <% } %>
    </section>
  </div>
  <%- include("../Footer.ejs") %>
</body>
